# 開発ルール - 絶対に守ること

## 1. 動作しているコードには手を出さない
- **Chrome版が正常動作している場合、Chrome版のコードは一切変更しない**
- **Firefox版が正常動作している場合、Firefox版のコードは一切変更しない**
- 片方の修正で、もう片方を巻き込まない

## 2. 余計な機能を追加しない
- ユーザーが明示的に要求していない機能は絶対に追加しない
- 特に以下は厳禁：
  - ページ内へのボタン自動注入
  - 勝手なページ遷移や自動表示
  - 不要な遅延処理
  - 便利だと思っても勝手に追加しない

## 3. 問題解決のアプローチ
- ユーザーが「○○が表示される」と言ったら、その文字列で即座に全文検索
- 推測で動かず、実際のコードを確認してから修正
- スクリーンショットがあれば最優先で確認

## 4. 修正時の鉄則
- 修正対象を明確に特定してから作業する
- 関係ない部分のコードは読むだけで、絶対に変更しない
- 特にChrome版とFirefox版は独立して扱う

## 5. 過去の失敗例（二度と繰り返さない）
- Chrome版が動作していたのにFirefox版と一緒に修正して壊した
- 「Firefox版エクスポート」ボタンを勝手にページに追加した
- ダウンロード結果ページを「不要」と勘違いして削除した
- browser.downloads.download APIで通知バーを表示させた

## 6. Firefox版の重要な実装ポイント
- **新規タブ作成時のsetInterval処理は変更しない**（コミット17d6f0cで動作確認済み）
- **get_bookmarksメッセージハンドラーは必須**（結果ページでデータ取得に必要）
- **isDownloadingフラグは適切にリセットする**（制限到達時、エラー時）
- **openDownloadResultPage()関数を必ず実装**（結果ページへの遷移）
- **複雑な待機処理やリトライ処理は追加しない**（シンプルが最善）

## 最重要原則
**動いているものを壊すな。余計なことをするな。**
**コミット時点で動作していた実装をベースに、最小限の変更で機能追加する。**