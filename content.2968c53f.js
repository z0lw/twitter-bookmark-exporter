
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="bf2ce1c0-ad26-50c6-b43b-f1c12d974db2")}catch(e){}}();
var e,t,r,n;t={},r={},null==(n=(e=globalThis).parcelRequirece9f)&&((n=function(e){if(e in t)return t[e].exports;if(e in r){var n=r[e];delete r[e];var o={id:e,exports:{}};return t[e]=o,n.call(o.exports,o,o.exports),o.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){r[e]=t},e.parcelRequirece9f=n),(0,n.register)("1Alot",function(e,t){function r(e){let t=e.data.bookmark_timeline_v2?"bookmark_timeline_v2":"bookmark_collection_timeline";return e.data[t]}function n(e){return new Promise(t=>setTimeout(t,e))}chrome.runtime.onMessage.addListener(async function(e,t,o){let i;if("iconClicked"===e.action){let t=e.bookmarksURL.split("?")[0],o=e.bookmarksURL.split("?")[1],l=e.stopSortIndex,c=e.otherConfig,d=null,u=0;(i=document.createElement("div")).style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.backgroundColor="rgba(0, 0, 0, 0.75)",i.style.zIndex="9999",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center";let m=document.createElement("div");m.innerHTML=`
    <svg style="margin-right: 25px; scale: 0.75;" width="65px" height="65px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
      <g>
        <animateTransform attributeName="transform" type="rotate" values="0 33 33;270 33 33" begin="0s" dur="1.4s" fill="freeze" repeatCount="indefinite"/>
        <circle fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30" stroke-dasharray="187" stroke-dashoffset="610">
          <animate attributeName="stroke" values="#4285F4;#DE3E35;#F7C223;#1B9A59;#4285F4" begin="0s" dur="5.6s" fill="freeze" repeatCount="indefinite"/>
          <animateTransform attributeName="transform" type="rotate" values="0 33 33;135 33 33;450 33 33" begin="0s" dur="1.4s" fill="freeze" repeatCount="indefinite"/>
          <animate attributeName="stroke-dashoffset" values="187;46.75;187" begin="0s" dur="1.4s" fill="freeze" repeatCount="indefinite"/>
        </circle>
      </g>
    </svg>
    `,i.appendChild(m);var s,a=document.createElement("h1");for(a.textContent="Downloading... DO NOT close this tab.",a.style.color="#fff",a.style.fontFamily='"TwitterChirp",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif',i.appendChild(a),document.body||await n(500),document.body.appendChild(i);;){try{s=await function(e,t,r,n){var o=JSON.parse(decodeURIComponent(n.variables)),i=n.features;return e&&(o.cursor=e),fetch(`${r}?variables=${encodeURIComponent(JSON.stringify(o))}&features=${i}`,{headers:{accept:"*/*","accept-language":"en-US,en;q=0.9,zh-TW;q=0.8,zh;q=0.7",authorization:t.authorization,"cache-control":"no-cache","content-type":"application/json",pragma:"no-cache","sec-ch-ua":'"Chromium";v="112", "Google Chrome";v="112", "Not:A-Brand";v="99"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","sec-gpc":"1","x-csrf-token":t["x-csrf-token"],"x-twitter-active-user":"yes","x-twitter-auth-type":"OAuth2Session","x-twitter-client-language":"zh-tw"},referrer:"https://x.com/i/bookmarks",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).then(e=>e.json())}(d,e.creds,t,function(e){var t={};return e&&e.split("&").forEach(function(e){var r=e.split("="),n=decodeURIComponent(r[0]),o=r[1]||"";t[n]?Array.isArray(t[n])?t[n].push(o):t[n]=[t[n],o]:t[n]=o}),t}(o))}catch(e){chrome.runtime.sendMessage({action:"fetch_network_error",error:e.toString()}),await n(2e3);continue}let a=!1;(function(e){if(!e?.data)return!1;let t=r(e);return t?.timeline?.instructions?.[0]?.entries?.length>0})(s)&&(a=!0);let m=!1;s.errors&&s.errors.length>0&&(m=!0),m&&a&&chrome.runtime.sendMessage({action:"partial_fetch_error",payload:s}),m&&!a&&(chrome.runtime.sendMessage({action:"fetch_error",errors:s.errors}),!1===confirm("Twitter is overloaded with the current request, do you want to keep the current downloaded bookmarks or abort?")?(chrome.runtime.sendMessage({action:"abort"}),setTimeout(()=>{document.body.removeChild(i)},1e3)):chrome.runtime.sendMessage({action:"finish_download"}),await n(5e3));try{u+=s.data.bookmark_timeline_v2.timeline.instructions[0].entries.length}catch(e){}if(d=r(s).timeline.instructions[0].entries.find(e=>e.entryId.startsWith("cursor-bottom-")).content.value,chrome.runtime.sendMessage({action:"fetch_page",page:s}),2===r(s).timeline.instructions[0].entries.length)break;if(l&&"sortIndex"===l.type){if(function(e,t){let n=r(e),o=n?.timeline?.instructions?.[0]?.entries;return!!o&&!!o.find(e=>e.sortIndex<t)}(s,l.value))break}else if(l&&"count"===l.type){if(u>=l.value)break}else if(l&&"date"===l.type&&function(e,t){let n=r(e),o=n?.timeline?.instructions?.[0]?.entries;return!!o&&!!o.find(e=>new Date(Number(BigInt(e.sortIndex)>>BigInt(20)))<new Date(t))}(s,l.value))break;let h=Math.max(100,Math.min(c.wait_interval_ms||1e3,1e4));await n(h)}chrome.runtime.sendMessage({action:"finish_download"}),setTimeout(()=>{i&&i.parentNode&&document.body.removeChild(i)},1e3)}else"abortConfirm"===e.action?!0===confirm("Do you want to stop the current downloading process?")&&(chrome.runtime.sendMessage({action:"abort"}),setTimeout(()=>{i&&i.parentNode&&document.body.removeChild(i)},1e3)):"selectAllBookmarks"===e.action&&document.querySelector('a[href="/i/bookmarks/all"]').click()}),document.location.href.includes("bookmarks")&&function(e,t){new MutationObserver((r,n)=>{let o=document.querySelector(e);o&&(t(o),n.disconnect())}).observe(document.documentElement,{childList:!0,subtree:!0})}('div[data-testid="primaryColumn"] div[aria-haspopup="menu"]',e=>{let t=document.createElement("div");t.title="Export bookmarks",t.innerHTML=`
    <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M13 11L21.2 2.80005" stroke="#292D32" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M22 6.8V2H17.2" stroke="#292D32" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M11 2H9C4 2 2 4 2 9V15C2 20 4 22 9 22H15C20 22 22 20 22 15V13" stroke="#292D32" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  `,t.addEventListener("click",()=>{chrome.runtime.sendMessage({action:"start_download"})}),t.style.position="absolute",t.style.width="50px",t.style.height="50px",t.style.right="33px",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",e.parentNode.insertBefore(t,e)})}),n("1Alot");
//# sourceMappingURL=content.2968c53f.js.map

//# debugId=bf2ce1c0-ad26-50c6-b43b-f1c12d974db2
